<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rocky Mountain - United States National Parks</title>
    <link rel="stylesheet" href="parks_style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.skypack.dev/maplibre-gl/dist/maplibre-gl.css">    

</head>

<body>
    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="logo">
                <a href="#" class="nav-link">
                    <span class="link-text">US National Parks</span>
                    <svg 
                        aria-hidden="true" 
                        focusable="false" 
                        data-prefix="fas" 
                        data-icon="bars" 
                        class="svg-inline--fa fa-bars fa-w-14" 
                        role="img" 
                        xmlns="http://www.w3.org/2000/svg" 
                        viewBox="0 0 448 512"
                    >
                        <path 
                        fill="currentColor" 
                        d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z">
                        </path>
                    </svg>
                </a>
            </li>
            <li class="nav-item">
                <a href="/project/index.html" class="nav-link">
                    <svg 
                        aria-hidden="true" 
                        focusable="false" 
                        data-prefix="fas" 
                        data-icon="map-marked-alt" 
                        class="svg-inline--fa fa-map-marked-alt fa-w-18" 
                        role="img" 
                        xmlns="http://www.w3.org/2000/svg" 
                        viewBox="0 0 576 512"
                    >
                        <path 
                            fill="currentColor" 
                            d="M288 0c-69.59 0-126 56.41-126 126 0 56.26 82.35 158.8 113.9 196.02 6.39 7.54 17.82 7.54 24.2 0C331.65 284.8 414 182.26 414 126 414 56.41 357.59 0 288 0zm0 168c-23.2 0-42-18.8-42-42s18.8-42 42-42 42 18.8 42 42-18.8 42-42 42zM20.12 215.95A32.006 32.006 0 0 0 0 245.66v250.32c0 11.32 11.43 19.06 21.94 14.86L160 448V214.92c-8.84-15.98-16.07-31.54-21.25-46.42L20.12 215.95zM288 359.67c-14.07 0-27.38-6.18-36.51-16.96-19.66-23.2-40.57-49.62-59.49-76.72v182l192 64V266c-18.92 27.09-39.82 53.52-59.49 76.72-9.13 10.77-22.44 16.95-36.51 16.95zm266.06-198.51L416 224v288l139.88-55.95A31.996 31.996 0 0 0 576 426.34V176.02c0-11.32-11.43-19.06-21.94-14.86z">
                        </path>
                    </svg>
                    <span class="link-text">Map</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="/project/list.html" class="nav-link">
                    <svg 
                        aria-hidden="true" 
                        focusable="false" 
                        data-prefix="fas" 
                        data-icon="list-ul" 
                        class="svg-inline--fa fa-list-ul fa-w-16" 
                        role="img" 
                        xmlns="http://www.w3.org/2000/svg" 
                        viewBox="0 0 512 512"
                    >
                        <path 
                            fill="currentColor" 
                            d="M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z">
                        </path>
                    </svg>
                    <span class="link-text">List View</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="/project/search.html" class="nav-link">
                    <svg 
                        aria-hidden="true" 
                        focusable="false" 
                        data-prefix="fas" 
                        data-icon="search" 
                        class="svg-inline--fa fa-search fa-w-16" 
                        role="img" 
                        xmlns="http://www.w3.org/2000/svg" 
                        viewBox="0 0 512 512"
                    >
                        <path 
                        fill="currentColor" 
                        d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
                        </path>
                    </svg>
                    <span class="link-text">Search</span>
                </a>
            </li>
            <li class="caption">
                <a href="#" class="nav-link">
                    <span class="link-text">Created by Michael Allcock - CS361</span>
                </a>
            </li>
        </ul>
    </nav>
    <header>
        <h1>United States National Parks</h1>
    </header>
    
    <main>
    <div>
        <div class="title">
            <h2 id="pname"></h2>
        </div>
        
        <div class="info">
            <img id="parkImg" src="/project/img/romo.jpeg" alt="Rocky Mountain National Park">

            <div id="results">
                <p id="state"></p>
                <p id="geo"></p>
                <p id="date"></p>
                <p id="area"></p>
                <p id="vis"></p>
                <p id="web"></p>
            </div>
        </div>
        
        <div class="map">
            <div id="my-map" >
                <iframe  width="1000" height="600"></iframe>
            </div>
        </div>
    </div>
    </main>

    <!--Script to populate Park info-->
    <script>
        searchSubmit();

        async function searchSubmit(event) {
            //event.preventDefault();
            const response = await fetch('/all');
            const parkData = await response.json();
            //console.log(parkData);

            var input = "Rocky Mountain";
            var data = getData(parkData, input);
            //console.log(input);
            //console.log(data);
        
            str1 = input + " National Park";
            str2 = "State: " + data.State;
            str3 = "Coordinates: " + data.Latitude + "°" + ", " + data.Longitude + "°";
            str4 = "Date Established: " + data.Date_Established;
            str5 = "Area (km^2): " + data.Area;
            str6 = "Visitors in 2019: " + data.Visitors;
            str7 = "Website: ";
            website = data.Website

            pname.innerHTML = str1;
            state.innerHTML = str2;
            geo.innerHTML = str3;
            date.innerHTML = str4;
            area.innerHTML = str5;
            vis.innerHTML = str6;
            web.innerHTML = str7 + website.link(website);

        }
        // Function to find search input
        function getData (obj, key) {
            if( key in obj )
                {
                    //console.log( obj[key] );
                    return obj[key];
                }
            else
            {
                console.log( "The key '" + key + "' is not in obj." );
            }
        };

    </script>

    <!--Script for Map element-->
    <script type="module">
        import maplibregl from 'https://cdn.skypack.dev/maplibre-gl@2.0.0-pre.5';

        
        // Map Script
        // Input lon and lat
        const lon = -105.690322; 
        const lat = 40.326351;

        function drawMap(maplibregl){
            const mapTilerKey = "b1f46c812f0f4a7485e46c797622ab4a"    
            const map = new maplibregl.Map({
            container: "my-map",
            style: `https://maps.geoapify.com/v1/styles/osm-carto/style.json?apiKey=${mapTilerKey}`,
            center: [lon, lat],
            zoom: 9
            })
            

            map.addControl(new maplibregl.NavigationControl());
            

            return map;
        };

        var map = drawMap(maplibregl);

        addMarkerFromLonLatArr([[lon, lat]])

        // addMarkerFromLonLatArr[[lon_1,lat_1],[lon_2,lat_2]...[lon_i,lat_i]]
        function addMarkerFromLonLatArr(arr){
            // I kept it in terms of i so if you have another array that 
            // has information about said marker you can still reference it
            //let bounds = new maplibregl.LngLatBounds(); // defines the bounds 
            for (let i = 0; i < arr.length; i++){
                let icon = document.createElement('div');
                icon.classList.add("icon");
                icon.setAttribute("id", "icon" + i);
                // This step above allows you to add event handlers for each icon
                let iconPopup = new maplibregl.Popup({
                    anchor: 'bottom',
                    offset: [0, -64] // height - shadow
                })
                .setText('Rocky Mountain National Park');
            
                let iconMarker = new maplibregl.Marker(icon, {
                    anchor: 'bottom',
                    offset: [0, 6]
                })
                .setLngLat(arr[i])
                .setPopup(iconPopup)
                .addTo(map);

                //map.setCenter(arr[i])
                // icon.onclick = (event) => {
                    // you can add custom logic here. For example, modify popup.
                //    iconPopup.setHTML(`<p>${event.target.getAttribute('id')}</p>`);
                //    event.stopPropagation();
                //}

                icon.onmouseenter = () => iconMarker.togglePopup(); // show/hide popup on mouse hover
                icon.onmouseleave = () => iconMarker.togglePopup();

            }
            
        }

    </script>

</body>

</html>